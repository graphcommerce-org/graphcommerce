import { makeStyles, Theme } from '@material-ui/core'
import clsx from 'clsx'
import React from 'react'
import { UseStyles } from '@graphcommerce/next-ui/Styles'
import AppShellProvider from '@graphcommerce/next-ui/AppShell/AppShellProvider'
import ShellBase, { PageLayoutBaseProps } from '@graphcommerce/next-ui/AppShell/ShellBase'

const useStyles = makeStyles(
  (theme: Theme) => ({
    root: {
      minHeight: '100vh',
      display: 'grid',
      gridTemplateRows: `auto 1fr auto`,
      gridTemplateColumns: '100%',
      backgroundColor: theme.palette.background.default,
      backgroundSize: 'cover',
      backgroundPosition: 'top-left',
      backgroundImage:
        'url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTY4MHB4IiBoZWlnaHQ9IjU5MzhweCIgdmlld0JveD0iMCAwIDE2ODAgNTkzOCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDx0aXRsZT5iZzwvdGl0bGU+CiAgICA8ZyBpZD0iYmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xOTM1LjQzNDcsLTYzLjUyOTMgQzE5MzUuNDM0NywtNjMuNTI5MyAxODg3Ljc0NDcsLTE4OS4wOTEzIDE4MzEuMTY1NywtMTk5LjcyMjMgQzE3NzQuNTg2NywtMjEwLjM1MzMgMTc0MC40Mzg3LC0yMzYuMjg3MyAxNjQ2LjEwOTcsLTIwOC4zMzYzIEMxNTUxLjc4MDcsLTE4MC4zODIzIDE0OTEuNjQ4NywtMTQ4LjU3ODMgMTQyNy45Nzg3LC0xMTguNTQ0MyBDMTM2NC4zMTE3LC04OC41MTAzIDEyOTcuMDk1NywtMjQuODgyMyAxMjkzLjUyNDcsNjEuNzU3NyBDMTI4OS45NTM3LDE0OC4zOTc3IDEzNTIuMTcyNywzMDcuNzYwNyAxNDI0LjQ0ODcsMzYxLjYyMDcgQzE0OTYuNzI4Nyw0MTUuNDgwNyAxNjY4LjIyNDcsNDYxLjUyNDcgMTc2OS4wNDk3LDM3NC45MjI3IEMxODY5Ljg3MTcsMjg4LjMyMDcgMTk5MC4xNTM3LDE4MC41MDc3IDE5NzIuNTA3Nyw4My4yNDY3IEMxOTU0Ljg2NDcsLTE0LjAxMDMgMTkzNS40MzQ3LC02My41MjkzIDE5MzUuNDM0NywtNjMuNTI5MyIgaWQ9IkZpbGwtMyIgZmlsbD0iI0Y1RTdFNiI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0xNDgxLjc2NTMsMTM1NS42NjgyIEMxNDgxLjc2NTMsMTM1NS42NjgyIDE0MjYuMzI0MywxMjA5LjY5OTIgMTM2MC41NTAzLDExOTcuMzQxMiBDMTI5NC43NzYzLDExODQuOTgyMiAxMjU1LjA3ODMsMTE1NC44MzQyIDExNDUuNDE5MywxMTg3LjMyNzIgQzEwMzUuNzYwMywxMjE5LjgyNDIgOTY1Ljg1NDMsMTI1Ni43OTcyIDg5MS44MzczLDEyOTEuNzEyMiBDODE3LjgyMzMsMTMyNi42MjcyIDczOS42ODMzLDE0MDAuNTk3MiA3MzUuNTMxMywxNTAxLjMxNzIgQzczMS4zODAzLDE2MDIuMDM4MiA4MDMuNzExMywxNzg3LjMwMTIgODg3LjczMzMsMTg0OS45MTQyIEM5NzEuNzYwMywxOTEyLjUyNzIgMTE3MS4xMjgzLDE5NjYuMDU0MiAxMjg4LjMzOTMsMTg2NS4zNzcyIEMxNDA1LjU0NjMsMTc2NC43MDAyIDE1NDUuMzc3MywxNjM5LjM2NjIgMTUyNC44NjMzLDE1MjYuMjk4MiBDMTUwNC4zNTMzLDE0MTMuMjM1MiAxNDgxLjc2NTMsMTM1NS42NjgyIDE0ODEuNzY1MywxMzU1LjY2ODIiIGlkPSJGaWxsLTY1IiBmaWxsPSIjRjVFN0U2Ij48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE2ODMuNTc2OSwxNjM1LjU2MzUgQzE2ODMuNTc2OSwxNjM1LjU2MzUgMTYzOC44MDc5LDE1OTkuMDQ3NSAxNjE1LjQ0NTksMTYwNy4yNTU1IEMxNTkyLjA4MjksMTYxNS40NjM1IDE1NzMuNzg1OSwxNjEzLjE0NzUgMTU0NC42NTg5LDE2NDMuODQ2NSBDMTUxNS41MzI5LDE2NzQuNTQ2NSAxNDk5Ljk3MjksMTY5OS4zMjU1IDE0ODIuNzE0OSwxNzI0LjIwNjUgQzE0NjUuNDU3OSwxNzQ5LjA4NjUgMTQ1NC4xMDM5LDE3ODcuMjQ1NSAxNDcxLjQwNjksMTgyMC4yODY1IEMxNDg4LjcwOTksMTg1My4zMjg1IDE1NDYuMTYwOSwxODk5LjMxMTUgMTU4NC42NjY5LDE5MDMuODMwNSBDMTYyMy4xNzQ5LDE5MDguMzQ4NSAxNjk2Ljk2MDksMTg4OC42MTY1IDE3MTUuODkzOSwxODM0LjY3MjUgQzE3MzQuODI0OSwxNzgwLjczMDUgMTc1Ni40NDM5LDE3MTQuNzAwNSAxNzI4Ljk1MzksMTY4Mi4yNjU1IEMxNzAxLjQ2NDksMTY0OS44MzA1IDE2ODMuNTc2OSwxNjM1LjU2MzUgMTY4My41NzY5LDE2MzUuNTYzNSIgaWQ9IkZpbGwtNjciIGZpbGw9IiNGNUU3RTYiPjwvcGF0aD4KICAgICAgICA8cGF0aCBkPSJNMzM4LjE2NDYsMTM0MC4yODA4IEMzMzguMTY0NiwxMzQwLjI4MDggMjkwLjQ3NDYsMTIxNC43MTg4IDIzMy44OTU2LDEyMDQuMDg3OCBDMTc3LjMxNjYsMTE5My40NTY4IDE0My4xNjg2LDExNjcuNTIyOCA0OC44Mzk2LDExOTUuNDczOCBDLTQ1LjQ4OTQsMTIyMy40Mjc4IC0xMDUuNjIxNCwxMjU1LjIzMTggLTE2OS4yOTE0LDEyODUuMjY1OCBDLTIzMi45NTg0LDEzMTUuMjk5OCAtMzAwLjE3NDQsMTM3OC45Mjc4IC0zMDMuNzQ1NCwxNDY1LjU2NzggQy0zMDcuMzE2NCwxNTUyLjIwNzggLTI0NS4wOTc0LDE3MTEuNTcwOCAtMTcyLjgyMTQsMTc2NS40MzA4IEMtMTAwLjU0MTQsMTgxOS4yOTA4IDcwLjk1NDYsMTg2NS4zMzQ4IDE3MS43Nzk2LDE3NzguNzMxOCBDMjcyLjYwMTYsMTY5Mi4xMzA4IDM5Mi44ODM2LDE1ODQuMzE3OCAzNzUuMjM3NiwxNDg3LjA1NjggQzM1Ny41OTQ2LDEzODkuNzk5OCAzMzguMTY0NiwxMzQwLjI4MDggMzM4LjE2NDYsMTM0MC4yODA4IiBpZD0iRmlsbC03MCIgZmlsbD0iI0Y1RTdFNiI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0yODEuNTQyOCwyNjk4LjcyODMgQzI4MS41NDI4LDI2OTguNzI4MyAyMjQuOTE4OCwyNTQ5LjY0NTMgMTU3Ljc0MTgsMjUzNy4wMjIzIEM5MC41NjM4LDI1MjQuNDAwMyA1MC4wMTg4LDI0OTMuNjA5MyAtNjEuOTgwMiwyNTI2Ljc5NTMgQy0xNzMuOTc5MiwyNTU5Ljk4NjMgLTI0NS4zNzYyLDI1OTcuNzQ4MyAtMzIwLjk3MzIsMjYzMy40MDczIEMtMzk2LjU2NTIsMjY2OS4wNjczIC00NzYuMzczMiwyNzQ0LjYxNTMgLTQ4MC42MTMyLDI4NDcuNDg1MyBDLTQ4NC44NTMyLDI5NTAuMzU1MyAtNDEwLjk3OTIsMzEzOS41NzAzIC0zMjUuMTY0MiwzMjAzLjUyMDMgQy0yMzkuMzQ0MiwzMjY3LjQ2OTMgLTM1LjcyMzIsMzMyMi4xMzgzIDgzLjk4OTgsMzIxOS4zMTMzIEMyMDMuNjk3OCwzMTE2LjQ4ODMgMzQ2LjUxMjgsMjk4OC40NzkzIDMyNS41NjA4LDI4NzIuOTk5MyBDMzA0LjYxMjgsMjc1Ny41MjMzIDI4MS41NDI4LDI2OTguNzI4MyAyODEuNTQyOCwyNjk4LjcyODMiIGlkPSJGaWxsLTIzOSIgZmlsbD0iI0Y1RTdFNiI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0zNjIuNTc1NywzMTgyLjU2NDkgQzM2Mi41NzU3LDMxODIuNTY0OSAzMTYuODUxNywzMTQ1LjI2OTkgMjkyLjk5MDcsMzE1My42NTI5IEMyNjkuMTI5NywzMTYyLjAzNTkgMjUwLjQ0MTcsMzE1OS42Njk5IDIyMC42OTM3LDMxOTEuMDIzOSBDMTkwLjk0NTcsMzIyMi4zNzg5IDE3NS4wNTM3LDMyNDcuNjg3OSAxNTcuNDI3NywzMjczLjA5OTkgQzEzOS44MDI3LDMyOTguNTEwOSAxMjguMjA2NywzMzM3LjQ4MjkgMTQ1Ljg3ODcsMzM3MS4yMjk5IEMxNjMuNTUwNywzNDA0Ljk3NjkgMjIyLjIyNjcsMzQ1MS45Mzk5IDI2MS41NTU3LDM0NTYuNTU1OSBDMzAwLjg4NTcsMzQ2MS4xNjk5IDM3Ni4yNDU3LDM0NDEuMDE3OSAzOTUuNTgxNywzMzg1LjkyMjkgQzQxNC45MTc3LDMzMzAuODI4OSA0MzYuOTk3NywzMjYzLjM4OTkgNDA4LjkyMDcsMzIzMC4yNjI5IEMzODAuODQ0NywzMTk3LjEzNjkgMzYyLjU3NTcsMzE4Mi41NjQ5IDM2Mi41NzU3LDMxODIuNTY0OSIgaWQ9IkZpbGwtMjQyIiBmaWxsPSIjRjVFN0U2Ij48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTkxLjk3MTQsNDQ4Mi40NDM0IEM5MS45NzE0LDQ0ODIuNDQzNCAyMi42NDA0LDQzOTcuMzAzNCAtMTguNDIwNiw0NDAzLjYwMzQgQy01OS40ODA2LDQ0MDkuOTAzNCAtOTAuMDc0Niw0Mzk4LjU2NTQgLTE0NC45MzA2LDQ0NDQuNTAwNCBDLTE5OS43ODY2LDQ0OTAuNDM3NCAtMjMwLjU5MTYsNDUzMC41Njg0IC0yNjQuMjkyNiw0NTcwLjIzNTQgQy0yOTcuOTkyNiw0NjA5LjkwMjQgLTMyNC4wNjU2LDQ2NzYuNTQyNCAtMzAwLjY1ODYsNDc0NC42Njg0IEMtMjc3LjI1MTYsNDgxMi43OTU0IC0xODguMTI0Niw0OTIwLjQxOTQgLTEyMy42Nzc2LDQ5NDMuNjE3NCBDLTU5LjIyODYsNDk2Ni44MTQ0IDY5LjM0NjQsNDk1OC40Mzk0IDExMS4wODg0LDQ4NjUuMzM3NCBDMTUyLjgyOTQsNDc3Mi4yMzc0IDIwMS4yODg0LDQ2NTcuNjc5NCAxNjAuNTA3NCw0NTg2Ljc2OTQgQzExOS43MzA0LDQ1MTUuODYwNCA5MS45NzE0LDQ0ODIuNDQzNCA5MS45NzE0LDQ0ODIuNDQzNCIgaWQ9IkZpbGwtMjQ0IiBmaWxsPSIjRjVFN0U2Ij48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE3OTcuNjc0MywzMTE1LjUxMSBDMTc5Ny42NzQzLDMxMTUuNTExIDE3NDEuMDUwMywyOTY2LjQyOCAxNjczLjg3MzMsMjk1My44MDUgQzE2MDYuNjk1MywyOTQxLjE4MyAxNTY2LjE1MTMsMjkxMC4zOTIgMTQ1NC4xNTEzLDI5NDMuNTc4IEMxMzQyLjE1MjMsMjk3Ni43NjkgMTI3MC43NTUzLDMwMTQuNTMxIDExOTUuMTU5MywzMDUwLjE5IEMxMTE5LjU2NjMsMzA4NS44NSAxMDM5Ljc1ODMsMzE2MS4zOTggMTAzNS41MTgzLDMyNjQuMjY4IEMxMDMxLjI3ODMsMzM2Ny4xMzggMTEwNS4xNTIzLDM1NTYuMzUzIDExOTAuOTY3MywzNjIwLjMwMyBDMTI3Ni43ODczLDM2ODQuMjUyIDE0ODAuNDA5MywzNzM4LjkyMSAxNjAwLjEyMTMsMzYzNi4wOTYgQzE3MTkuODI5MywzNTMzLjI3MSAxODYyLjY0NDMsMzQwNS4yNjIgMTg0MS42OTIzLDMyODkuNzgyIEMxODIwLjc0NDMsMzE3NC4zMDYgMTc5Ny42NzQzLDMxMTUuNTExIDE3OTcuNjc0MywzMTE1LjUxMSIgaWQ9IkZpbGwtMjQ3IiBmaWxsPSIjRjVFN0U2Ij48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTEzMTEuNTM5Myw0OTYxLjk2ODYgQzEzMTEuNTM5Myw0OTYxLjk2ODYgMTM1Mi41MjQzLDUwNjkuODc3NiAxNDAxLjE0OTMsNTA3OS4wMTQ2IEMxNDQ5Ljc3MzMsNTA4OC4xNTA2IDE0NzkuMTIwMyw1MTEwLjQzNzYgMTU2MC4xODczLDUwODYuNDE2NiBDMTY0MS4yNTQzLDUwNjIuMzkyNiAxNjkyLjkzMzMsNTAzNS4wNjA2IDE3NDcuNjUxMyw1MDA5LjI0ODYgQzE4MDIuMzY3Myw0OTgzLjQzNzYgMTg2MC4xMzMzLDQ5MjguNzU0NiAxODYzLjIwMjMsNDg1NC4yOTU2IEMxODY2LjI3MTMsNDc3OS44MzY2IDE4MTIuODAwMyw0NjQyLjg3ODYgMTc1MC42ODUzLDQ1OTYuNTkwNiBDMTY4OC41NjczLDQ1NTAuMzAyNiAxNTQxLjE4MjMsNDUxMC43MzI2IDE0NTQuNTMyMyw0NTg1LjE1OTYgQzEzNjcuODg1Myw0NjU5LjU4NTYgMTI2NC41MTMzLDQ3NTIuMjQwNiAxMjc5LjY3ODMsNDgzNS44Mjc2IEMxMjk0Ljg0MTMsNDkxOS40MTE2IDEzMTEuNTM5Myw0OTYxLjk2ODYgMTMxMS41MzkzLDQ5NjEuOTY4NiIgaWQ9IkZpbGwtMjUwIiBmaWxsPSIjRjVFN0U2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==")',
    },

    hideFabsOnVirtualKeyboardOpen: {
      [theme.breakpoints.down('sm')]: {
        '@media (max-height: 530px)': {
          display: 'none',
        },
      },
    },
    header: {
      display: 'flex',
      alignItems: 'center',
      justifyContent: 'center',
      [theme.breakpoints.up('md')]: {
        padding: `${theme.spacings.xxs} ${theme.page.horizontal} 0`,
        marginBottom: theme.spacings.xxs,
        top: 0,
        display: 'flex',
        pointerEvents: 'none',
        justifyContent: 'left',
        width: '100%',
        height: theme.page.headerInnerHeight.md,
      },
    },
    headerAlwaysShow: {
      [theme.breakpoints.down('sm')]: {
        marginTop: 20,
        marginBottom: 22,
      },
    },
  }),
  { name: 'FullPageShellBase' },
)

export type FullPageShellBaseProps = {
  header: React.ReactNode
  footer: React.ReactNode
  menuFab?: React.ReactNode
  cartFab?: React.ReactNode
  children?: React.ReactNode
  alwaysShowHeader?: boolean
} & UseStyles<typeof useStyles> &
  PageLayoutBaseProps

export default function FullPageShellBase(props: FullPageShellBaseProps) {
  const { children, header, footer, menuFab, cartFab, name, alwaysShowHeader } = props
  const classes = useStyles(props)

  return (
    <div className={classes.root}>
      <AppShellProvider>
        <ShellBase name={name}>
          <header className={clsx(classes.header, alwaysShowHeader && classes.headerAlwaysShow)}>
            {header}
          </header>
          <div>
            <div className={classes.hideFabsOnVirtualKeyboardOpen}>
              {menuFab}
              {cartFab}
            </div>
            {children}
          </div>
          <div>{footer}</div>
        </ShellBase>
      </AppShellProvider>
    </div>
  )
}
